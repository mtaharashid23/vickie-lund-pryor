function preLoader() {
    const preLoader = document.querySelector(".preloader");
    if (!preLoader) return;
    let counts = setInterval(updated, 4);
    let upto = 0;

    function updated() {
        let count = document.querySelector(".preloader .counter span");
        count.innerHTML = ++upto;
        if (upto === 100) {
            clearInterval(counts);
            animateLoader();
        }
    }

    function animateLoader() {
        const tl = gsap.timeline({
            duration: 0.1,
        });

        tl.to(".preloader h5", {
                autoAlpha: 0,
            })
            .to(".preloader .counter", {
                autoAlpha: 0,
            })
            .to(".preloader .line", {
                width: '100vw',
            })
            .to(".preloader .line", {
                xPercent: 100,
            })
            .to(".preloader .bar", {
                height: 0,
                stagger: 0.09,
                ease: "power4.inOut",
            })
            .to(".preloader", {
                css: {
                    display: "none",
                },
            })
            .from(".header-main__logo > h3", {
                y: -50,
                autoAlpha: 0,
            }, "show")
            .from(".header-main__nav > .nav-item", {
                autoAlpha: 0,
                y: -50,
                stagger: 0.05,
            })
            .from(".main-banner", {
                autoAlpha: 0,
                duration: 1,
            }, "show")
            .from(".main-banner__content", {
                autoAlpha: 0,
                yPercent: 100,
                stagger: 0.05,
            }, "show")            
            .from(".main-banner__img", {
                autoAlpha: 0,
                xPercent: 100,
            }, "show")
            .from(".bannercardSlider .swiper-wrapper .swiper-slide", {
                autoAlpha: 0,
                yPercent: 100,
                stagger: 0.05,
            }, "show");        
    }
}

function lenisSetup() {
	const lenis = new Lenis({
		duration: 1.5,
		easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
		smooth: true,
		mouseMultiplier: 1,
	});

	function raf(time) {
		lenis.raf(time);
		requestAnimationFrame(raf);
	}
	requestAnimationFrame(raf);
	document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
		anchor.addEventListener("click", function (e) {
			e.preventDefault();
			lenis.scrollTo(this.getAttribute("href"));
		});
	});
	lenis.scrollTo("top");
}

function replaceHash() {
	document.querySelectorAll("a").forEach((a) => {
		let href = a.getAttribute("href");
		a.href = href ?
			href.startsWith("#") && href.endsWith("#") ?
			href.replace("#", "javascript:void(0)") :
			href :
			"javascript:void(0)";
	});
}

function sliderInit() {		
	var bannercardSlider = new Swiper('.bannercardSlider', {
		loop: true,
        speed: 1000,
        autoplay: true,
		slidesPerView: 1,
		spaceBetween: 20,
		breakpoints: {
			992: {
				slidesPerView: 3,
				spaceBetween: 30
			},
			576: {
				slidesPerView: 2,
				spaceBetween: 20
			},						
			375: {
				slidesPerView: 1,
				spaceBetween: 10
			}
		}		
	});

	var reviewSlider = new Swiper('.reviewSlider', {
		loop: true,
        speed: 1000,
        autoplay: true,
		slidesPerView: 1,
		spaceBetween: 20,
		breakpoints: {
			992: {
				slidesPerView: 3,
				spaceBetween: 30
			},
			576: {
				slidesPerView: 2,
				spaceBetween: 20
			}			
		}
	});

    var articleSlider = new Swiper('.articleSlider', {
		loop: true,
		freeMode: true,
		freeModeMomentum: false,
		slidesPerView: 2,
		spaceBetween: 10,		
		autoplay: {
			delay: 1,
			disableOnInteraction: true,
			reverseDirection: true,
		},		
		speed: 3000,
		centeredSlides: true,
		breakpoints: {
			992: {
				slidesPerView: 4,
				spaceBetween: 30
			},
			768: {
				slidesPerView: 3,
				spaceBetween: 20
			},			
			375: {
				slidesPerView: 3,
				spaceBetween: 10
			}			
		},		
	});
}

function headingAnimation() {
    const headings = document.querySelectorAll(".mainHeading");
    const subHeading = document.querySelectorAll(".subHeading");

    headings.forEach((text) => {
        let text1 = new SplitType(text, {
            types: "chars",
        });
        const headingTl = gsap.timeline({
            scrollTrigger: {
                trigger: text,
                toggleActions: "play none none reset",
            },
        });
        let chars = text.querySelectorAll(".char");
        headingTl.from(chars, 1.2, {
            y: 80,
            opacity: 0,
            scale: 1.2,
            rotationX: -90,
            transformOrigin: "bottom center",
            stagger: 0.05,
            ease: "expo.out",
        });
    });

    subHeading.forEach((text) => {
        let text1 = new SplitType(text, {
            types: "chars",
        });
        const subHeadingTl = gsap.timeline({
            scrollTrigger: {
                trigger: text,
                toggleActions: "play none none reset",
            },
        });
        let chars = text.querySelectorAll(".char");
        subHeadingTl.from(chars, 1.2, {
            y: -80, // Changed to negative value
            opacity: 0,
            scale: 1.2,
            rotationX: 90, // Adjusted to rotate from the top
            transformOrigin: "top center", // Changed to match the new direction
            stagger: 0.1,
            ease: "expo.out",
        });
    });
}

function mouseCursor() {
    if (document.querySelector(".cursor-inner") || document.querySelector(".cursor-outer")) {
        const cursorInner = document.querySelector(".cursor-inner");
        const cursorOuter = document.querySelector(".cursor-outer");
        let mouseX = 0;
        let mouseY = 0;
        window.addEventListener("mousemove", function (event) {
            gsap.to(cursorOuter, {
                x: event.clientX,
                y: event.clientY,
            });
            gsap.to(cursorInner, {
                x: event.clientX,
                y: event.clientY,
            });
            mouseY = event.clientY;
            mouseX = event.clientX;
        });
    }
}

function btnHover() {
    const buttons = gsap.utils.toArray(".themeBtn");
    buttons.forEach((item) => {
        let text1 = new SplitType(item, {
            types: "chars",
        });
        let chars = item.querySelectorAll(".char");
        let tl = gsap.timeline({
            paused: true,
        });

        tl.to(chars, {
            duration: 0.5,
            yPercent: -150,
            ease: "power2.in",
        });
        tl.set(chars, {
            yPercent: 150,
        });
        tl.to(chars, {
            duration: 0.5,
            yPercent: 0,
            stagger: 0.1,
            ease: "back.inOut(3)",
        });

        item.addEventListener("mouseenter", () => tl.play(0));
    });
}

$(function () {
    preLoader();
	sliderInit()		
	headingAnimation()
	btnHover()
	mouseCursor()
	replaceHash()
	lenisSetup()
	AOS.init({
		duration: 1500,
		disable: "mobile",
	});	
})